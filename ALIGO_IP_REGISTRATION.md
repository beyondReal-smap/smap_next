# 알리고 SMS IP 등록 가이드

## 🎯 등록할 IP 주소

다음 **2개의 Fixie 고정 IP 주소**를 알리고 SMS 서비스에 등록해야 합니다:

```
52.5.155.132
52.87.82.133
```

---

## 📝 알리고 IP 등록 절차

### 1단계: 알리고 관리자 페이지 접속

**URL**: https://smartsms.aligo.in/

**로그인 정보**:
- 아이디: `smap2023`
- 비밀번호: (기존 사용 중인 비밀번호)

### 2단계: IP 화이트리스트 설정 메뉴 찾기

로그인 후 다음 경로로 이동:

```
관리자 페이지 → 환경설정 → IP 접근 제한 설정
```

또는

```
관리자 페이지 → API 설정 → IP 화이트리스트
```

*참고: 메뉴 위치는 알리고 관리자 페이지 버전에 따라 다를 수 있습니다.*

### 3단계: IP 주소 등록

1. **"IP 추가" 또는 "허용 IP 등록"** 버튼 클릭

2. 첫 번째 IP 등록:
   ```
   IP 주소: 52.5.155.132
   설명: Fixie Proxy 1
   ```

3. 두 번째 IP 등록:
   ```
   IP 주소: 52.87.82.133
   설명: Fixie Proxy 2
   ```

4. **저장** 버튼 클릭

### 4단계: 등록 확인

- IP 화이트리스트에 2개의 IP가 표시되는지 확인
- 상태가 "활성" 또는 "사용"으로 표시되는지 확인

### 5단계: 반영 대기

- IP 등록 후 **5-10분** 정도 대기
- 알리고 시스템에 변경사항이 반영되는 시간 필요

---

## 🧪 등록 확인 테스트

IP 등록 후 다음 명령어로 테스트:

```bash
curl -X POST https://api3.smap.site/api/v1/sms/send-verification-code \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "본인_휴대폰_번호"}'
```

**성공 응답**:
```json
{
  "success": true,
  "code": "123456"
}
```

**실패 응답 (IP 미등록)**:
```json
{
  "success": false,
  "error": "허용되지 않은 IP에서의 접근입니다"
}
```

---

## 🔍 문제 해결

### ❌ 문제: IP 등록 메뉴를 찾을 수 없음

**해결 방법**:
1. 알리고 고객센터에 문의: **1661-5179**
2. "API 사용을 위한 IP 화이트리스트 설정 방법" 문의
3. 또는 알리고 온라인 고객센터 이용

### ❌ 문제: IP 등록 권한이 없음

**해결 방법**:
1. 관리자 계정으로 로그인했는지 확인
2. 계정에 API 사용 권한이 있는지 확인
3. 알리고 고객센터에 권한 요청

### ❌ 문제: IP 등록 후에도 SMS 발송 실패

**해결 방법**:
1. 10분 정도 더 대기 (반영 시간)
2. 등록한 IP 주소가 정확한지 재확인:
   - 52.5.155.132
   - 52.87.82.133
3. 알리고 관리자 페이지에서 IP 상태 확인
4. 알리고 API 키가 유효한지 확인

---

## 📞 알리고 고객센터 정보

**전화**: 1661-5179  
**운영 시간**: 평일 09:00 - 18:00  
**이메일**: help@aligo.in  
**웹사이트**: https://smartsms.aligo.in/

---

## 📋 등록 완료 체크리스트

- [ ] 알리고 관리자 페이지 로그인 완료
- [ ] IP 화이트리스트 설정 메뉴 접근
- [ ] IP 1: 52.5.155.132 등록 완료
- [ ] IP 2: 52.87.82.133 등록 완료
- [ ] 등록 상태 "활성" 확인
- [ ] 5-10분 대기
- [ ] 테스트 SMS 발송 성공

모두 체크되면 IP 등록 완료! ✅

---

## 💡 추가 정보

### IP 화이트리스트란?

특정 IP 주소에서만 API 호출을 허용하는 보안 기능입니다.

**장점**:
- 무단 API 사용 방지
- 보안 강화
- API 키 유출 시에도 등록된 IP에서만 사용 가능

**단점**:
- IP 변경 시 재등록 필요
- 동적 IP 환경에서 사용 불가 (→ Fixie 프록시로 해결)

### Fixie IP 변경 시

Fixie에서 IP가 변경될 경우:
1. Fixie 대시보드에서 새로운 IP 확인
2. 알리고에 새 IP 등록
3. 기존 IP는 삭제 또는 유지

---

## 🔐 보안 권장사항

1. **정기적인 IP 확인**
   - 월 1회 Fixie 대시보드에서 IP 변경 여부 확인

2. **API 키 보안**
   - 알리고 API 키는 환경 변수로만 관리
   - GitHub 등 공개 저장소에 노출 금지

3. **접근 로그 모니터링**
   - 알리고 관리자 페이지에서 API 호출 로그 정기 확인
   - 비정상적인 호출 패턴 감지

---

이 가이드를 따라 IP 등록을 완료하면 Vercel 환경에서도 안정적으로 SMS를 발송할 수 있습니다! 🚀

